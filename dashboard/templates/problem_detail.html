{% extends "base.html" %}

{% block title %}{{ problem.problem_id }} - Code Quality Dashboard{% endblock %}

{% block content %}
<div class="container">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">Problems</a></li>
            <li class="breadcrumb-item active">{{ problem.problem_id }}</li>
        </ol>
    </nav>

    <!-- Problem Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="card-title mb-0">
                        <i class="fas fa-code"></i> {{ problem.function_name }}
                        <small class="text-light">({{ problem.problem_id }})</small>
                    </h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-2">
                            <strong>LOC:</strong> {{ problem.metrics.loc or 'N/A' }}
                        </div>
                        <div class="col-md-2">
                            <strong>LLOC:</strong> {{ problem.metrics.lloc or 'N/A' }}
                        </div>
                        <div class="col-md-2">
                            <strong>Complexity:</strong> {{ problem.metrics.cyclomatic_complexity or 'N/A' }}
                        </div>
                        <div class="col-md-2">
                            <strong>Maintainability:</strong> {{ problem.metrics.maintainability_index or 'N/A' }}
                        </div>
                        <div class="col-md-2">
                            <strong>Cognitive:</strong> {{ problem.metrics.cognitive_complexity or 'N/A' }}
                        </div>
                        <div class="col-md-2">
                            <strong>Security Issues:</strong> {{ problem.metrics.security_issues or 'N/A' }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Code Sections -->
    <div class="row">
        <!-- Prompt -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-question"></i> Problem Prompt
                    </h5>
                </div>
                <div class="card-body">
                    <pre><code class="language-python">{{ problem.prompt }}</code></pre>
                </div>
            </div>
        </div>

        <!-- Solution -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-check"></i> Canonical Solution
                    </h5>
                </div>
                <div class="card-body">
                    <pre><code class="language-python">{{ problem.canonical_solution }}</code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Tests -->
    <div class="row">
        <div class="col-12 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-vial"></i> Test Cases
                    </h5>
                </div>
                <div class="card-body">
                    <pre><code class="language-python">{{ problem.test }}</code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Metrics Details -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-chart-bar"></i> Detailed Metrics
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        {% for metric_name, metric_value in problem.metrics.items() %}
                        <div class="col-md-3 mb-2">
                            <strong>{{ metric_name.replace('_', ' ').title() }}:</strong> 
                            {{ metric_value if metric_value is not none else 'N/A' }}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Initialize syntax highlighting
if (typeof hljs !== 'undefined') {
    hljs.highlightAll();
}
</script>
{% endblock %}